<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>AxoData | System.Dynamic.ExpandoObject </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="AxoData | System.Dynamic.ExpandoObject ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../images/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="../../styles/custom.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">  
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
  
  <meta property="docfx:rel" content="../../">
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <p class="text-logo">AXOpen</p>
              </a>            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="axodata">AxoData</h1>

<p>AXOpen.Data library provides a simple yet powerful data exchange between PLC and an arbitrary data repository. It includes the implementation of a series of repository operations known as CRUD (Create Read Update Delete) accessible directly from the PLC.</p>
<h2 id="benefits">Benefits</h2>
<p>The main benefit of this solution is data scalability; once the repository is set up, any modification of the data structure(s) will result in an automatic update of mapped objects. And therefore, there is no need for additional coding and configuration.</p>
<h2 id="how-it-works">How it works</h2>
<p>The basic PLC block is <code>AxoDataExchange</code>, which has its .NET counterpart (or .NET twin) that handles complex repository operations using a modified <code>AxoRemoteTask</code>, which is a form of RPC (Remote Procedure Call), that allows you to execute the code from the PLC in a remote .NET application.</p>
<h2 id="implemented-repositories">Implemented repositories</h2>
<p>The <code>AxoDataExchange</code> uses a predefined interface <code>IRepository</code> that allows for the virtually unlimited implementation of different kinds of target repositories.</p>
<p>At this point, AXOpen supports these repositories directly:</p>
<ul>
<li>InMemory</li>
<li>Json</li>
<li>MongoDB</li>
<li>RavenDB</li>
</ul>
<h2 id="getting-started">Getting started</h2>
<p>For the data exchange to work, we will need to create our CLASS extending the <code>AxoDataExchange</code> class. We can call it <code>MyDataExchanger</code>. Don't forget to add using:</p>
<pre><code>using AXOpen.data;
</code></pre>
<pre><code>CLASS MyDataExchanger EXTENDS AXOpen.Data.DataExchange 
</code></pre>
<p>We will also need to add our data entity variable, which contains the data that we want to exchange between PLC and the repository. This variable must be annotated with <code>DataEntityAttribute</code>. This attribute must be assigned to only one member <code>AxoDataExchange</code> object and is used to locate data object that contains data to be exchanged between PLC and the target repository. When <code>DataEntityAttribute</code> is missing or multiple members have the annotation, an exception is thrown.</p>
<pre><code>CLASS MyDataExchanger EXTENDS AXOpen.data.DataExchange
    VAR PUBLIC
        {#ix-attr:[AXOpen.Data.AxoDataEntityAttribute]}
        MyDataToExchange : MyData;
    END_VAR  
END_CLASS  
</code></pre>
<p>The data entity variable must be of a class that extends <code>AxoDataEntity</code>. So let's just create CLASS that will have some variables.</p>
<pre><code>CLASS MyData EXTENDS AXOpen.data.DataEntity
    VAR PUBLIC
        sampleData : REAL;
        someInteger : INT;
        someString : STRING;
    END_VAR 
END_CLASS
</code></pre>
<p>As mentioned earlier, we use remote calls to execute the CRUD operations. These calls are a variant of <code>AxoTask</code> which can operate asynchronously, and we will need to call it cyclically.</p>
<p>We will now need to create an instance of <code>MyDataExchanger</code> in a context object (or as a member of another class). And, we will need to call <code>_myDataExchanger</code> in the Main method of appropriate context (Just to remind ourselves all logic in AXOpen must be placed in the call tree of a Main method of a context).</p>
<pre><code>CLASS MyContext EXTENDS AXOpen.core.IxContext    
    VAR PUBLIC         
        _myDataExchanger: MyDataExchanger;
    END_VAR

    METHOD OVERRIDE PUBLIC Main
        _myDataExchanger.Run(THIS);
    END_METHOD
END_CLASS
</code></pre>
<p>Instantiate context in a configuration</p>
<pre><code>CONFIGURATION MyConfiguration
    VAR_GLOBAL
        _myContext : MyContext;       
    END_VAR
END_CONFIGURATION
</code></pre>
<p>Execute the context in a program</p>
<pre><code>PROGRAM MAIN
VAR_EXTERNAL
    _myContext : MyContext;
END_VAR
//-------------------------------------------------
//-------------------------------------------------
_myContext.Run();
</code></pre>
<p>At this point, we have everything ready in the PLC.</p>
<p>We will now need to tell the <code>_myDataExchanger</code> what repository we will use. We will work with data stored in files in JSON format.</p>
<p>Let's create a configuration for the repository:</p>
<pre><code class="lang-C#">var storageDir = Path.Combine(Environment.CurrentDirectory, &quot;MyDataExchangeData&quot;);
var repository = AXOpen.Repository.Json.Repository.Factory(new JsonRepositorySettings&lt;MyData&gt;(storageDir));
</code></pre>
<p>Note: <code>MyData</code> should be type from <code>Pocos</code>.</p>
<p>Then we will need to associate the repository with the PLC object and initialize the data exchange operations.</p>
<pre><code class="lang-C#">Entry.Plc.MainContext.MyDataExchanger.InitializeRemoteDataExchange(repository);
</code></pre>
<p>Now we can freely shuffle the data between PLC and the local folder.</p>
<pre><code>IF(_create) THEN
    IF(_myDataExchanger.Create(_id).Done) THEN
        _create := FALSE;
    END_IF;
END_IF;

IF(_read) THEN
    IF(_myDataExchanger.Read(_id).Done) THEN
        _read := FALSE;
    END_IF;
END_IF;

IF(_update) THEN
    IF(_myDataExchanger.Update(_id).Done) THEN
        _update := FALSE;
    END_IF;
END_IF;

IF(_delete) THEN
    IF(_myDataExchanger.Delete(_id).Done) THEN
        _delete := FALSE;
    END_IF;
END_IF;
</code></pre>
<h2 id="data-visualization">Data visualization</h2>
<p>With presentation <code>Command</code> there are available options for adding, editing and deleting records.</p>
<p><a href="../../images/Command.png">!Command</a></p>
<p>If you use <code>Status</code> presentation type, data will be only displayed cannot be manipulated.</p>
<p><a href="../../images/Status.png">!Status</a></p>
<h3 id="custom-columns">Custom columns</h3>
<p>There is a possibility to add custom columns if it is needed. You must add <code>AXOpen.core.IxDataExchange.ColumnData</code> view as a child in <code>IxDataView</code>. The <code>BindingValue</code> must be set in <code>ColumnData</code> and contains string representing attribute name of custom columns. If you want to add custom header name, you can simply set the name in <code>HeaderName</code> attribute. Also, there is an attribute to make column not clickable, which is clickable by default. The example using all attributes:</p>
<pre><code>&lt;IxDataView Vm=&quot;@ViewModel.DataViewModel&quot; Presentation=&quot;Command&quot;&gt;
    &lt;AXOpen.core.IxDataExchange.ColumnData HeaderName=&quot;Recipe name&quot; BindingValue=&quot;RecipeName&quot; /&gt;
    &lt;AXOpen.core.IxDataExchange.ColumnData BindingValue=&quot;String1&quot; Clickable=&quot;false&quot; /&gt;
&lt;/IxDataView&gt;
</code></pre>
<p><a href="../../images/CustomColumns.png">!Custom columns</a></p>
<h3 id="export">Export</h3>
<p>If you want to be able to export data, you must add <code>CanExport</code> attribute with <code>true</code> value. Like this:</p>
<pre><code>&lt;AxoDataView Vm=&quot;@ViewModel.DataViewModel&quot; Presentation=&quot;Command&quot; CanExport=&quot;true&quot; /&gt;
</code></pre>
<p>With this option, buttons for export and import data will appear. After clicking on export button, the csv file will be created, which contains all existing records. If you want import data, you must upload csv file with equal data structure like we get in export file.</p>
<p><a href="../../images/Export.png">!Export</a></p>
<h3 id="modal-detail-view">Modal detail view</h3>
<p>The Detail View is default shown like modal view. That means if you clicked on some record, the modal window with detail view will be shown. If necessary, this option can be changed with <code>ModalDetailView</code> attribute. This change will show detail view under the record table. Example with <code>ModalDetailView</code> attribute:</p>
<pre><code>&lt;AxoDataView Vm=&quot;@ViewModel.DataViewModel&quot; Presentation=&quot;Command&quot; ModalDetailView=&quot;false&quot; /&gt;
</code></pre>
<p><a href="../../images/NotModalDetailView.png">!Not Modal detail view</a></p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ix-ax/AXOpen/blob/add-application-templates-for-integration-testing/docfx/articles/data/README.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
       Generated by DocFx. © Peter Kurhajec, MTS spol. s r.o., and awesome contributors
      
          </div>
        </div>
      </footer>
    </div>
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>
    <script src="https://unpkg.com/highlightjs-dotnetconfig@0.9.3/dist/dotnetconfig.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
    <script type="text/javascript" src="https://unpkg.com/mermaid@8.10.2/dist/mermaid.min.js" integrity="sha384-nzpOk138h0/O14Ig1PAUlf1XSo5T+XvpBUVkpLaU40QBvMgrNkSKusdNAomDLEd2" crossorigin="anonymous"></script>
    <script>
    mermaid.initialize({
    startOnLoad: false
    });
    mermaid.init(undefined, ".lang-mermaid");
    </script>  </body>
</html>
